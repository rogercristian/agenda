Instalar Helmet e CSURF
npm i helmet csurf

no server.js importar apos o path

const helmet = require('helmet');
const csrf = require('csurf');

executar ates da rota

app.use(helmet());
(...)

app.use(csrf());

// criar middleware (pasta e arquivo)
exports.checkCsrfErr= (err, req, res, next) =>{
 if(err && 'EBADCSRFTOKEN' === err.code){
    return res.render('error');
 }  
};

exports.csrfMiddleware = (req, res, next) =>{
    res.locals.csrfToken = req.csrfToken();
    next();
};

exports.middlewareLocal = (req,res,next) =>{
    res.locals.variavelLocal = 'titulo é uma variavel local';
    next();
}


// importar no server

const {checkCsrfErr, csrfMiddleware, middlewareLocal} = require('./src/middlewares/middlewares');

executar antes da routes
//middlewares
app.use(checkCsrfErr);
app.use(csrfMiddleware);
app.use(middlewareLocal);


//form pra testar segurança

   <h1>
      <%= variavelLocal %>
    </h1>

    <form action="/" method="post">
      <input type="hidden" name="_csrf" value="<%= csrfToken %>">
      <input type="text" name="cliente" placeholder="Cliente">
      <button>Enviar</button>
    </form>
// OBS : criar na views uma pagina de erro pra ser exibida